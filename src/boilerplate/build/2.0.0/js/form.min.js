define(["jquery"],function(o){o.fn.krForm=function(a){a=jQuery.extend({textOnLoading:"Sendet",textOnError:"<strong>Ein Fehler ist aufgetreten!</strong><br>Bitte füllen Sie alle mit einem * markierten Felder aus!",textOnSuccess:"<strong>Vielen Dank für Ihre Nachricht.</strong><br>Wir setzen uns in Kürze mit Ihnen in Verbindung"},a);var t=o(this),n=t.find('button[type="submit"]'),r=n.text(),e=t.find('input[name="required"]').val().split(",");for(i in e)val=e[i],t.find("label[for='"+val.trim()+"']").append("*");return setButtonState=function(e){return"loading"===e?n.addClass("kr-button-loading").text(a.textOnLoading).prop("disabled",!0):"reset"===e?n.removeClass("kr-button-loading").text(r).removeAttr("disabled"):void 0},makeAlert=function(e,t){var n=o("<div>",{class:"kr-form-alert",style:"animation-duration:"+a.alertDuration/1e3/2+"s"}),r=o("<i>",{class:"fa fa-lg fa-window-close kr-form-alert-close","aria-hidden":!0}).click(function(){n.remove()});n.addClass(e).html("<p class='h-margin-remove'>"+t+"</p>").prepend(r)},removeAlert=function(e){e.remove()},setToSuccess=function(){var e;return setButtonState("reset"),e=makeAlert("-success",a.textOnSuccess),o("body").append(e),e.fadeIn(),t.find("input, select, textarea, button").attr("disabled",!0)},setToError=function(){var e;return setButtonState("reset"),e=makeAlert("-error",a.textOnError),o("body").append(e),e.fadeIn()},t.on("submit",function(e){return e.preventDefault(),o.ajax({url:t.attr("action"),type:t.attr("method"),data:t.serialize(),beforeSend:function(){return setButtonState("loading")},statusCode:{302:function(){return setToSuccess()},200:function(){return setToSuccess()},400:function(){return setToError()}}})}),this}});